<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chat Page</title>
    <link rel="stylesheet" href="../css/chat-styles.css" />
  </head>
  <body>
    <div class="chat-container">
      <div class="contacts-list">
        <div class="search-container">
          <input type="text" id="searchContacts" placeholder="Search contacts..." />
          <i class="search-icon">&#128269;</i>
        </div>
        <div class="contact-list-content">
          <!-- Matched Contact -->
          <div class="contact" id="matchedContact">
            <a href="../html/minigame puzzle.html" id="matchedContactLink">
              <img src="" alt="Matched Contact" id="matchedContactImage" class="sparkle-border" />
            </a>
            <div class="contact-info">
              <h3 id="matchedContactName">Matched Contact</h3>
              <p>Online</p>
            </div>
          </div>
        </div>
      </div>
      <div class="chat-window">
        <div class="chat-header">
          <a href="../html/minigame puzzle.html" id="chatContactLink">
            <img src="" alt="Matched Contact" id="chatContactImage" class="sparkle-border pulse flash" />
          </a>
          <h2 id="chatContactName">Matched Contact</h2>
        </div>
        <div class="chat-messages">
          <!-- Messages will be injected here -->
        </div>
        <div class="chat-input">
          <input type="text" id="messageInput" placeholder="Type a message..." disabled />
          <button id="sendButton" disabled>Send</button>
        </div>
        <div class="response-options" id="responseOptions"></div>
        <button id="startDay2Button">Start Day 2</button>
        <button id="startDay3Button" style="display: none;">Start Day 3</button>
        <button id="startDay4Button">Start Day 4</button>
        <button id="startDay5Button">Start Day 5</button>
      </div>
    </div>

    <button id="saveProgressButton">Save Progress</button>

    <div id="achievementPopup" class="achievement-popup">
      <div class="achievement-content">
        <h3>Achievement Unlocked!</h3>
        <p>"First Date"</p>
      </div>
    </div>

    <div id="phoneContainer" class="phone-container">
      <div class="phone-frame">
          <div class="phone-content">
              <div class="call-interface">
                  <div class="call-header">
                      <div class="contact-photo-container">
                          <img src="" alt="John Doe" class="contact-photo" id="contact-photo">
                      </div>
                      <div class="contact-info">
                          <h2 id="contact-name" class="contact-name">John Doe</h2>
                          <div id="calling-status" class="calling-status">Incoming call</div>
                      </div>
                  </div>
                  <div id="call-duration" class="call-duration">00:00</div>
                  <div class="audio-player">
                      <button id="microphone-btn" class="microphone-btn">
                          <i class="fas fa-microphone"></i>
                      </button>
                  </div>
                  <div id="reply-options" class="reply-options"></div>
                  <div id="start-prompt" class="start-prompt">
                      <div class="arrow"></div>
                      <span>Tap mic to start</span>
                  </div>
              </div>
          </div>
      </div>
  </div>

  <audio id="audio-element"></audio>
  <div id="blockingLayer" class="blocking-layer"></div>
  <!-- <audio id="bg-music" loop src="../audio/Chatting Page - 11pm Animal Crossing Wild World.mp3">
  </audio> -->
  <!-- Transparent blur background -->
<div class="blur-background" id="blurBackground"></div>



    <script src="../javascript/chat-script.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        // Retrieve the last matched name and image from localStorage
        const matchedName = localStorage.getItem('lastMatchedName');
        const matchedImage = localStorage.getItem('lastMatchedImage');

        if (matchedName && matchedImage) {
          // Update the contact list with the matched profile's details
          document.getElementById('matchedContactName').textContent = matchedName;
          document.getElementById('matchedContactImage').src = matchedImage;

          // Update the chat window with the matched profile's details
          document.getElementById('chatContactName').textContent = matchedName;
          document.getElementById('chatContactImage').src = matchedImage;
        }
      });
    </script>
  </body>
</html>
